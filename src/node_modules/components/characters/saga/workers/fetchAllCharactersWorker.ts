import {call, put} from 'redux-saga/effects';
import {charactersApi, planetsApi} from "services/axios";
import {SagaIterator} from "@redux-saga/types";
import {allPlanetsSuccess, putAllPlanets} from "components/planets/planetsActions";
import {allCharactersSuccess, putAllCharacters} from "components/characters/charactersActions";

const delay = (ms:number) => new Promise(resolve => setTimeout(resolve, ms))

const fetchAllCharacters = () => {
    return charactersApi.getCharactersList()
}

export function* fetchAllCharactersWorker(): SagaIterator {

    const charactersList = yield call(fetchAllCharacters)
    yield put(putAllCharacters(charactersList.results))

    yield call(delay, 3000)
    yield put(allCharactersSuccess())
}